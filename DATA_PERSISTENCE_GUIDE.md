# 數據持久化功能說明

## 🎯 功能概述

Base Encoder Extension 現在支援數據持久化功能，讓您在重新開啟擴充功能時，能夠自動恢復上次的輸入內容、設定和結果。

## 💾 保存的內容

### 編碼/解碼區塊
- ✅ 輸入文字內容
- ✅ 選擇的編碼格式 (Base64/Base58)
- ✅ 編碼/解碼模式選擇
- ✅ 處理結果

### 進制轉換區塊
- ✅ 來源進制設定
- ✅ 目標進制設定
- ✅ 輸入的數字
- ✅ 轉換結果

### UI 狀態
- ✅ 當前活動的標籤頁
- ✅ 所有輸入欄位的內容
- ✅ 選擇的選項和設定

## 🔄 使用體驗

### 典型使用場景
1. **工作進行中**: 正在進行 Base64 編碼工作
2. **意外關閉**: 不小心關閉了擴充功能視窗
3. **重新開啟**: 點擊擴充功能圖示重新開啟
4. **自動恢復**: 所有內容自動恢復，無需重新輸入

### 跨會話保持
- 即使完全關閉瀏覽器
- 重新啟動電腦
- 數據仍會保留並在下次使用時自動恢復

## ⚙️ 技術實現

### 儲存機制
```javascript
// 優先使用 Chrome Storage API
if (chrome.storage && chrome.storage.local) {
    chrome.storage.local.set({'encoderExtensionData': data});
} else {
    // 備用 localStorage
    localStorage.setItem('encoderExtensionData', JSON.stringify(data));
}
```

### 自動觸發保存
數據會在以下情況自動保存：
- 輸入內容變更時
- 切換標籤頁時
- 變更設定時
- 執行編碼/解碼操作後
- 執行進制轉換操作後

### 載入時機
- 擴充功能 popup 開啟時
- DOM 內容載入完成後
- 在設定預設值之前

## 🛡️ 隱私與安全

### 資料儲存位置
- **Chrome Storage**: 儲存在 Chrome 的擴充功能專用空間
- **Local Storage**: 作為備用方案，儲存在瀏覽器本地
- **不會上傳**: 所有資料僅儲存在本地，不會傳送到任何伺服器

### 資料清除方式
1. **清除按鈕**: 使用進制轉換的「清除」按鈕
2. **手動清除**: 
   ```javascript
   // 開發者控制台執行
   chrome.storage.local.remove(['encoderExtensionData']);
   localStorage.removeItem('encoderExtensionData');
   ```
3. **重設擴充功能**: 在 Chrome 擴充功能管理頁面重新安裝

## 🔧 故障排除

### 數據沒有保存
1. 檢查 Chrome 版本是否支援 Storage API
2. 確認擴充功能有 `storage` 權限
3. 檢查瀏覽器是否啟用了無痕模式

### 數據載入異常
1. 檢查控制台是否有錯誤訊息
2. 嘗試清除儲存的數據重新開始
3. 確認 manifest.json 中的權限設定

### 相容性問題
- **支援版本**: Chrome 88+ (Manifest V3)
- **備用機制**: localStorage 適用於較舊版本
- **測試建議**: 在不同 Chrome 版本中測試

## 📋 測試指南

### 基本測試
1. 在編碼區塊輸入文字
2. 選擇不同的編碼格式
3. 關閉並重新開啟擴充功能
4. 驗證內容是否完整恢復

### 進制轉換測試
1. 設定來源進制為 16，目標進制為 10
2. 輸入 "FF"，執行轉換
3. 切換到編碼標籤頁，再切換回來
4. 驗證設定和結果是否保持

### 跨會話測試
1. 完整設定兩個標籤頁的內容
2. 完全關閉瀏覽器
3. 重新啟動瀏覽器
4. 開啟擴充功能驗證數據保持

## 💡 使用技巧

### 最佳實踐
- 習慣性地進行一些輸入，讓系統自動保存
- 善用標籤頁切換，每次切換都會觸發保存
- 定期使用「清除」功能重設為預設狀態

### 效率提升
- 利用數據保持功能，無需重複輸入常用內容
- 在多個工作之間切換時，每個功能區塊的狀態都會獨立保存
- 重新開啟時會自動回到上次使用的標籤頁

這個功能讓 Base Encoder Extension 更加人性化，提供更流暢的使用體驗！
