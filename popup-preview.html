<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–°ç‰ˆ Popup ä»‹é¢é è¦½</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f0f0f0;
        }
        .preview-container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .preview-header {
            background: #007cba;
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
        }
    </style>
    <link rel="stylesheet" href="src/popup/popup.css">
</head>
<body>
    <h1 style="text-align: center; color: #333;">ğŸ¨ æ–°ç‰ˆ Popup ä»‹é¢é è¦½</h1>
    
    <div class="preview-container">
        <div class="preview-header">Chrome æ“´å……åŠŸèƒ½é è¦½</div>
        
        <div class="container">
            <h1>ç·¨ç¢¼/è§£ç¢¼å™¨</h1>
            
            <!-- åŠŸèƒ½é¸æ“‡æ¨™ç±¤ -->
            <div class="tab-container">
                <button class="tab-button active" id="encode-tab">ç·¨ç¢¼/è§£ç¢¼</button>
                <button class="tab-button" id="convert-tab">é€²åˆ¶è½‰æ›</button>
            </div>
            
            <!-- ç·¨ç¢¼/è§£ç¢¼å€å¡Š -->
            <div class="tab-content active" id="encode-section">
                <div class="mode-selection">
                    <label>
                        <input type="radio" name="mode" value="encode" checked>
                        ç·¨ç¢¼
                    </label>
                    <label>
                        <input type="radio" name="mode" value="decode">
                        è§£ç¢¼
                    </label>
                </div>
                
                <textarea id="input" placeholder="è¼¸å…¥è¦è™•ç†çš„å…§å®¹">Hello ä¸–ç•Œ ğŸ˜€</textarea>
                
                <div class="format-selection">
                    <label>é¸æ“‡æ ¼å¼:</label>
                    <select id="format">
                        <option value="base64">Base64</option>
                        <option value="base58">Base58</option>
                    </select>
                </div>
                
                <div class="action-button">
                    <button id="process">ç·¨ç¢¼</button>
                </div>
                
                <h2>çµæœ</h2>
                <textarea id="output" placeholder="ç·¨ç¢¼çµæœ" readonly>SGVsbG8g5LiW55WMIPCfmIA=</textarea>
            </div>
            
            <!-- é€²åˆ¶è½‰æ›å€å¡Š -->
            <div class="tab-content" id="convert-section">
                <div class="convert-input-group">
                    <div class="base-input-row">
                        <div class="base-input-half">
                            <label>ä¾†æºé€²åˆ¶ (2-36):</label>
                            <input type="number" id="fromBase" min="2" max="36" value="36" placeholder="ä¾†æºé€²åˆ¶">
                        </div>
                        <div class="base-input-half">
                            <label>ç›®æ¨™é€²åˆ¶ (2-36):</label>
                            <input type="number" id="toBase" min="2" max="36" value="10" placeholder="ç›®æ¨™é€²åˆ¶">
                        </div>
                    </div>
                    
                    <label>è¼¸å…¥æ•¸å­—:</label>
                    <textarea id="convertInput" placeholder="ä¾‹å¦‚: ZZ" rows="3">ZZ</textarea>
                    
                    <div class="action-button">
                        <button id="convertButton">è½‰æ›</button>
                        <button id="clearButton" class="secondary">æ¸…é™¤</button>
                    </div>
                </div>
                
                <h2>è½‰æ›çµæœ</h2>
                <textarea id="convertOutput" placeholder="è½‰æ›çµæœ" readonly>ZZ (36é€²åˆ¶) = 1295 (10é€²åˆ¶)</textarea>
                
                <div class="base-reference">
                    <small>
                        <strong>é€²åˆ¶åƒè€ƒ:</strong> 
                        2é€²åˆ¶(0,1) | 8é€²åˆ¶(0-7) | 10é€²åˆ¶(0-9) | 16é€²åˆ¶(0-9,A-F) | 36é€²åˆ¶(0-9,A-Z)
                    </small>
                </div>
            </div>
        </div>
    </div>
    
    <div style="text-align: center; margin-top: 20px; color: #666;">
        <p><strong>ä¸»è¦æ”¹é€²ï¼š</strong></p>
        <ul style="display: inline-block; text-align: left;">
            <li>âœ… ç·¨ç¢¼/è§£ç¢¼å’Œé€²åˆ¶è½‰æ›å®Œå…¨åˆ†é›¢</li>
            <li>âœ… æ¨™ç±¤é å¼ä»‹é¢ï¼Œæ›´æ¸…æ™°çš„åŠŸèƒ½åŠƒåˆ†</li>
            <li>âœ… é€²åˆ¶è½‰æ›æ”¯æ´ä¾†æºå’Œç›®æ¨™é€²åˆ¶è¨­å®š</li>
            <li>âœ… æ›´ç›´è§€çš„æ“ä½œæµç¨‹</li>
            <li>âœ… ä¿æŒ Chrome æ“´å……åŠŸèƒ½çš„ç·Šæ¹Šè¨­è¨ˆ</li>
        </ul>
    </div>
    
    <script src="src/utils/encoders.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // æ¨™ç±¤é å…ƒç´ 
            const encodeTab = document.getElementById("encode-tab");
            const convertTab = document.getElementById("convert-tab");
            const encodeSection = document.getElementById("encode-section");
            const convertSection = document.getElementById("convert-section");

            // æ¨™ç±¤é åˆ‡æ›åŠŸèƒ½
            function switchTab(activeTab, activeSection) {
                // ç§»é™¤æ‰€æœ‰æ´»å‹•ç‹€æ…‹
                document.querySelectorAll('.tab-button').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(section => section.classList.remove('active'));
                
                // æ·»åŠ æ´»å‹•ç‹€æ…‹
                activeTab.classList.add('active');
                activeSection.classList.add('active');
            }

            // æ¨™ç±¤é äº‹ä»¶ç›£è½
            encodeTab.addEventListener("click", () => switchTab(encodeTab, encodeSection));
            convertTab.addEventListener("click", () => switchTab(convertTab, convertSection));

            // ç·¨ç¢¼/è§£ç¢¼åŠŸèƒ½
            const processButton = document.getElementById("process");
            const inputField = document.getElementById("input");
            const outputField = document.getElementById("output");
            const formatSelect = document.getElementById("format");
            const modeRadios = document.querySelectorAll('input[name="mode"]');

            function updateEncodeInterface() {
                const selectedMode = document.querySelector('input[name="mode"]:checked').value;
                const isEncode = selectedMode === "encode";
                processButton.textContent = isEncode ? "ç·¨ç¢¼" : "è§£ç¢¼";
            }

            modeRadios.forEach((radio) => {
                radio.addEventListener("change", updateEncodeInterface);
            });

            processButton.addEventListener("click", function () {
                const inputText = inputField.value.trim();
                const selectedFormat = formatSelect.value;
                const selectedMode = document.querySelector('input[name="mode"]:checked').value;

                if (inputText === "") return;

                try {
                    let result;
                    if (selectedMode === "encode") {
                        switch (selectedFormat) {
                            case "base64":
                                result = base64Encode(inputText);
                                break;
                            case "base58":
                                result = base58Encode(inputText);
                                break;
                        }
                    } else {
                        switch (selectedFormat) {
                            case "base64":
                                result = base64Decode(inputText);
                                break;
                            case "base58":
                                result = base58Decode(inputText);
                                break;
                        }
                    }
                    outputField.value = result;
                    outputField.className = "success";
                } catch (error) {
                    outputField.value = `éŒ¯èª¤: ${error.message}`;
                    outputField.className = "error";
                }
            });

            // é€²åˆ¶è½‰æ›åŠŸèƒ½
            const convertButton = document.getElementById("convertButton");
            const clearButton = document.getElementById("clearButton");
            const convertInput = document.getElementById("convertInput");
            const convertOutput = document.getElementById("convertOutput");
            const fromBaseInput = document.getElementById("fromBase");
            const toBaseInput = document.getElementById("toBase");

            convertButton.addEventListener("click", function () {
                const inputText = convertInput.value.trim();
                const fromBase = parseInt(fromBaseInput.value);
                const toBase = parseInt(toBaseInput.value);

                if (inputText === "") return;

                try {
                    const result = baseConvert(inputText, fromBase, toBase);
                    convertOutput.value = `${inputText} (${fromBase}é€²åˆ¶) = ${result} (${toBase}é€²åˆ¶)`;
                    convertOutput.className = "success";
                } catch (error) {
                    convertOutput.value = `éŒ¯èª¤: ${error.message}`;
                    convertOutput.className = "error";
                }
            });

            clearButton.addEventListener("click", function () {
                convertInput.value = "";
                convertOutput.value = "";
                convertOutput.className = "";
                fromBaseInput.value = "36";
                toBaseInput.value = "10";
            });

            // åˆå§‹åŒ–
            updateEncodeInterface();
        });
    </script>
</body>
</html>
